{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"genbadge","text":"<p>Generate badges for tools that do not provide one.</p> <p> </p> <p> </p> <p><code>genbadge</code> provides a set of commandline utilities to generate badges for tools that do not provide one. It currently can create: </p> <ul> <li><code>tests</code> badges such as  from <code>pytest</code> or other <code>junit.xml</code>-generating framework,</li> <li><code>coverage</code> badges such as  from python <code>coverage</code> or other <code>coverage.xml</code>-generating framework, </li> <li><code>flake8</code> badges such as  from <code>flake8 --statistics</code>. </li> </ul> <p>Badges are either generated using the shields.io HTTP REST API, or with an equivalent local SVG template included in <code>genbadge</code>.</p>"},{"location":"#installing","title":"Installing","text":""},{"location":"#full","title":"Full","text":"<p>In order for all commandline features to work, you should install <code>genbadge</code> with the extra dependencies:</p> <pre><code>&gt; pip install genbadge[all]\n</code></pre> <p>This is equivalent to <code>pip install genbadge[tests,coverage,flake8]</code>. Alternatively you can install dependencies for only a subset of commands for example <code>pip install genbadge[tests,flake8]</code>.</p>"},{"location":"#minimal","title":"Minimal","text":"<p><code>genbadge</code> core only requires <code>click</code> (the CLI framework), <code>pillow</code> (for SVG file templating) and <code>requests</code> (to call the shields.io API). You can install it using</p> <pre><code>&gt; pip install genbadge\n</code></pre> <p>This will only allow you to use the low-level API.</p>"},{"location":"#usage","title":"Usage","text":"<p>Once installed, <code>genbadge</code> is available as a commandline utility. You can get some help with:</p> <pre><code>&gt; genbadge\n\nUsage: genbadge [OPTIONS] COMMAND [ARGS]...\n\n  Commandline utility to generate badges. To get help on each command use:\n\n      genbadge &lt;cmd&gt; --help\n\nOptions:\n  --help  Show this message and exit.\n\nCommands:\n  coverage  Generate a badge for the coverage results (e.g. from a\n            coverage.xml).\n  flake8    Generate a badge for the flake8 results (e.g. from a flake8stats.txt\n            file).\n  tests     Generate a badge for the test results (e.g. from a junit.xml).\n</code></pre>"},{"location":"#1-tests-badge","title":"1. Tests badge","text":""},{"location":"#prerequisite-a-test-report","title":"Prerequisite: a test report","text":""},{"location":"#a-pytest","title":"a. <code>pytest</code>","text":"<p>If you use <code>pytest</code>, you can use some options to generate test reports:</p> <ul> <li> <p>with <code>--junitxml=path/to/junit.xml</code> a junit-format report is generated. This is the file that we'll need to generate the badge.</p> </li> <li> <p>with <code>--html=path/to/report.html</code> a detailed HTML report is generated. This is not required to generate the badge, but you might wish to use it so that users navigate to it when they will click on your badge. </p> </li> </ul> <p>Security concerns</p> <p>Test reports might contain secrets (keys, env variables, OS user names containing employee numbers, etc.), so always review them carefully before publishing them !</p> <p>Let's run this in your project:</p> <pre><code>&gt; pytest --junitxml=reports/junit/junit.xml --html=reports/junit/report.html\n</code></pre> <p>You can check that the two files are correctly generated before moving forward.</p>"},{"location":"#b-other-frameworks","title":"b. Other frameworks","text":"<p>Any <code>junit.xml</code> input file would be accepted so other language users (e.g. java) can get this working for them as well.</p>"},{"location":"#generating-the-badge","title":"Generating the badge","text":"<p>Now you can generate a badge similar to this one  with the following command:</p> <pre><code>&gt; genbadge tests\n</code></pre> <p>By default it assumes that</p> <ul> <li> <p>the input file can be found at <code>./reports/junit/junit.xml</code>. You can change this with the <code>-i/--input-file</code> flag. </p> <ul> <li><code>-</code> can be used to denote <code>&lt;stdin&gt;</code>: e.g. <code>genbadge tests -i - &lt; junit.xml</code>.</li> </ul> </li> <li> <p>the output file will be at <code>./tests-badge.svg</code>. You can change it with the <code>-o/--output-file</code> flag</p> <ul> <li><code>-</code> can be used to denote <code>&lt;stdout&gt;</code>: e.g. <code>genbadge tests -o - &gt; badge.svg</code>.</li> </ul> </li> <li> <p>the badge name (left-hand side text) is tests. You can change it with the <code>-n/--name</code> flag or clear it with <code>-n \"\"</code> (but keep the empty space). Alternatively if you want to completely remove the left-hand side of the badge you can use <code>--noname</code>.</p> </li> <li> <p>the badge should be generated using <code>shields.io</code> (requires an internet connection). If you prefer you can use <code>-l/--local</code> to use the included SVG file template (less mature but seems to work)</p> </li> </ul> <p>In addition to generating the badge, executing the command will also display some details about the parsed file is you use the verbose <code>-v</code> flag:</p> <pre><code>Test statistics parsed successfully from '(...)/reports/junit/junit.xml'\n - Nb tests: Total (6) = Success (2) + Skipped (1) + Failed (2) + Errors (1)\n - Success percentage: 40.00% (2 / 5) (Skipped tests are excluded)\n\nSUCCESS - Tests badge created: '(...)/tests-badge.svg'\n</code></pre> <p>Note that without the verbose flag, only the last line of this message is displayed. You can disable it entirely using the silent flag <code>-s</code>.</p> <p>The resulting badge will by default look like this: <code>[tests | 2/5]</code> where 2 is the number of tests that have run successfully, and 5 is the total number of tests minus the number of skipped tests. When all tests pass with success, the badge simply shows the number of tests: <code>[tests | 5]</code>. The success percentage, defined as this ratio multiplied by 100, is displayed and can be further used to fail on threshold, see below.</p> <p>Finally, the color of the badge depends on the success percentage.</p> <ul> <li>Less than 50%: red</li> <li>less than 75%: orange</li> <li>less than 90%: green</li> <li>higher: bright green</li> </ul>"},{"location":"#using-the-badge","title":"Using the badge","text":"<p>To include the resulting badge in your documentation and make it point to the generated <code>report.html</code>, you can for example use the following markdown:</p> <p><code>[![Tests Status](./reports/junit/junit-badge.svg?dummy=8484744)](./reports/junit/report.html)</code></p> <p>It will render as follows: </p> <p>Note that the query part of the image url <code>?dummy=8484744</code> is a trick so that the github pages web server does not try to add an extra cache layer to the badge. Maybe this is not useful anymore with new versions of github, if you know the answer let me know !</p> <p>Security concerns</p> <p>Test reports might contain secrets (keys, env variables, OS user names containing employee numbers, etc.), so always review them carefully before publishing them !</p>"},{"location":"#failing-on-threshold","title":"Failing on threshold","text":"<p>You might wish the command to fail if the success percentage is not high enough.</p> <p>This may be done using the <code>-t/--threshold</code> flag:</p> <pre><code>&gt; genbadge tests -t 90\n</code></pre> <p>will fail and return an exit code of <code>1</code> if the success percentage is strictly lower than 90%.</p> <p>The success percentage is defined as the number of tests that have run successfully, divided by the total number of tests minus the number of skipped tests, times 100. So for 6 tests run, if 2 tests ran successfully and 1 was skipped then the success percentage is <code>2 / (6 - 1) * 100</code> which gives <code>40%</code>.</p>"},{"location":"#2-coverage-badge","title":"2. Coverage badge","text":""},{"location":"#prerequisite-a-cov-report","title":"Prerequisite: a cov report","text":""},{"location":"#a-coverage","title":"a. <code>coverage</code>","text":"<p>If you use <code>coverage</code>, you can use some options to generate reports:</p> <ul> <li> <p>with <code>coverage report</code> the coverage statistics are displayed in the console. This is not required but might be useful to debug if the xml generation fails.</p> </li> <li> <p>with <code>coverage xml</code> an XML-format report is generated. This is the file that we'll need to generate the badge.</p> </li> <li> <p>with <code>coverage html</code> a detailed HTML report (a folder) is generated. This is not required to generate the badge, but you might wish to use it so that users navigate to it when they will click on your badge. </p> </li> </ul> <p>Let's run this in your project:</p> <pre><code>&gt; coverage report\n&gt; coverage xml\n&gt; coverage html\n</code></pre> <p>You can check that the coverage file and html report folder are correctly generated before moving forward.</p>"},{"location":"#b-other-frameworks_1","title":"b. Other frameworks","text":"<p>Any <code>coverage.xml</code> input file would be accepted so other language users (e.g. java) can get this working for them as well.</p>"},{"location":"#generating-the-badge_1","title":"Generating the badge","text":"<p>Now you can generate a badge similar to this one  with the following command:</p> <pre><code>&gt; genbadge coverage\n</code></pre> <p>By default it assumes that</p> <ul> <li> <p>the input file can be found at <code>./reports/coverage/coverage.xml</code>. You can change this with the <code>-i/--input-file</code> flag. </p> <ul> <li><code>-</code> can be used to denote <code>&lt;stdin&gt;</code>: e.g. <code>genbadge coverage -i - &lt; coverage.xml</code>.</li> </ul> </li> <li> <p>the output file will be at <code>./coverage-badge.svg</code>. You can change it with the <code>-o/--output-file</code> flag</p> <ul> <li><code>-</code> can be used to denote <code>&lt;stdout&gt;</code>: e.g. <code>genbadge coverage -o - &gt; badge.svg</code>.</li> </ul> </li> <li> <p>the badge name (left-hand side text) is coverage. You can change it with the <code>-n/--name</code> flag or clear it with <code>-n \"\"</code> (but keep the empty space). Alternatively if you want to completely remove the left-hand side of the badge you can use <code>--noname</code>.</p> </li> <li> <p>the badge should be generated using <code>shields.io</code> (requires an internet connection). If you prefer you can use <code>-l/--local</code> to use the included SVG file template (less mature but seems to work)</p> </li> </ul> <p>In addition to generating the badge, executing the command will also display some details about the parsed file is you use the verbose <code>-v</code> flag:</p> <pre><code>Coverage results parsed successfully from '(...)/reports/coverage/coverage.xml'\n - Branch coverage: 5.56% (1/18)\n - Line coverage: 17.81% (13/73)\n - Total coverage: 15.38% ((1+13)/(18+73))\n\nSUCCESS - Coverage badge created: '(...)/coverage-badge.svg'\n</code></pre> <p>Note that without the verbose flag, only the last line of this message is displayed. You can disable it entirely using the silent flag <code>-s</code>.</p> <p>The resulting badge will by default look like this: <code>[coverage | 98.1%]</code> where 98.1 is the total coverage, obtained from the branch and line coverages using the formula <code>(nb_lines_covered + nb_branches_covered) / (nb_lines / nb_branches)</code> and multiplying this by 100.</p> <p>Finally, the color of the badge depends on the success percentage.</p> <ul> <li>Less than 50%: red</li> <li>less than 75%: orange</li> <li>less than 90%: green</li> <li>higher: bright green</li> </ul>"},{"location":"#using-the-badge_1","title":"Using the badge","text":"<p>To include the resulting badge in your documentation and make it point to the generated HTML report, you can for example use the following markdown:</p> <p><code>[![Coverage Status](./reports/coverage/coverage-badge.svg?dummy=8484744)](./reports/coverage/index.html)</code></p> <p>It will render as follows: </p> <p>Note that the query part of the image url <code>?dummy=8484744</code> is a trick so that the github pages web server does not try to add an extra cache layer to the badge. Maybe this is not useful anymore with new versions of github, if you know the answer let me know !</p>"},{"location":"#3-flake8-badge","title":"3. Flake8 badge","text":""},{"location":"#prerequisite-a-flake8-report","title":"Prerequisite: a flake8 report","text":"<p>If you use <code>flake8</code>, you can use some options to generate reports:</p> <ul> <li> <p>with <code>--statistics</code>, the number of issues grouped by code (e.g. <code>E201</code>) is consolidated and printed to std out. You can redirect this to a file named <code>flake8stats.txt</code> using <code>--tee --output-file flake8stats.txt</code>. This is the file that we'll need to generate the badge. Note that <code>--tee</code> is to continue to see the report on the console, this is optional.</p> </li> <li> <p>with <code>--format=html --htmldir</code> a detailed HTML report (a folder) is generated. This is not required to generate the badge, but you might wish to use it so that users navigate to it when they will click on your badge. </p> </li> </ul> <p>Let's run this in your project. We use <code>--exit-zero</code> so that the commands always returns with exit code 0 even if problems are found.</p> <pre><code>&gt; flake8 &lt;src_folder&gt; --exit-zero --format=html --htmldir ./reports/flake8 --statistics --tee --output-file flake8stats.txt\n1     B014 Redundant exception types in `except (IOError, OSError):`.  Write `except OSError:`, which catches exactly the same exceptions.\n7     C801 Copyright notice not present.\n1     E122 continuation line missing indentation or outdented\n1     E303 too many blank lines (3)\n...\n</code></pre> <p>You can check that the statistics file and html report folder are correctly generated before moving forward.</p>"},{"location":"#generating-the-badge_2","title":"Generating the badge","text":"<p>Now you can generate a badge similar to this one  with the following command:</p> <pre><code>&gt; genbadge flake8\n</code></pre> <p>By default it assumes that</p> <ul> <li> <p>the input file can be found at <code>./reports/flake8/flake8stats.txt</code>. You can change this with the <code>-i/--input-file</code> flag. </p> <ul> <li><code>-</code> can be used to denote <code>&lt;stdin&gt;</code>: e.g. <code>genbadge flake8 -i - &lt; flake8stats.txt</code>.</li> </ul> </li> <li> <p>the output file will be at <code>./flake8-badge.svg</code>. You can change it with the <code>-o/--output-file</code> flag</p> <ul> <li><code>-</code> can be used to denote <code>&lt;stdout&gt;</code>: e.g. <code>genbadge flake8 -o - &gt; badge.svg</code>.</li> </ul> </li> <li> <p>the badge name (left-hand side text) is flake8. You can change it with the <code>-n/--name</code> flag or clear it with <code>-n \"\"</code> (but keep the empty space). Alternatively if you want to completely remove the left-hand side of the badge you can use <code>--noname</code>.</p> </li> <li> <p>the badge should be generated using <code>shields.io</code> (requires an internet connection). If you prefer you can use <code>-l/--local</code> to use the included SVG file template (less mature but seems to work)</p> </li> </ul> <p>In addition to generating the badge, executing the command will also display some details about the parsed file is you use the verbose <code>-v</code> flag:</p> <pre><code>Flake8 statistics parsed successfully from '(...)/reports/flake8/flake8stats.txt'\n - Total (20) = Critical (6) + Warning (9) + Info (5)\n\nSUCCESS - Flake8 badge created: '(...)/flake8-badge.svg'\n</code></pre> <p>Note that without the verbose flag, only the last line of this message is displayed. You can disable it entirely using the silent flag <code>-s</code>.</p> <p>The resulting badge will by default look like this: <code>[flake8 | 6 C, 0 W, 5 I]</code> where 6, 0, 5 denote the number of critical issues, warnings, and information messages respectively. These severity levels are determined by the <code>flake8-html</code> plugin so as to match the colors in the HTML report.</p> <p>Finally, the color of the badge depends on the number of issues at each severity level.</p> <ul> <li>at least a critical issue (severity 1): red</li> <li>at least a warning (severity 2): orange</li> <li>at least an info (severity 3): green</li> <li>no issue at all: bright green</li> </ul>"},{"location":"#using-the-badge_2","title":"Using the badge","text":"<p>To include the resulting badge in your documentation and make it point to the generated HTML report, you can for example use the following markdown:</p> <p><code>[![Flake8 Status](./reports/flake8/flake8-badge.svg?dummy=8484744)](./reports/flake8/index.html)</code></p> <p>It will render as follows: </p> <p>Note that the query part of the image url <code>?dummy=8484744</code> is a trick so that the github pages web server does not try to add an extra cache layer to the badge. Maybe this is not useful anymore with new versions of github, if you know the answer let me know !</p>"},{"location":"#4-low-level-api","title":"4. Low-level API","text":"<p>You can create a badge with the <code>Badge</code> class.</p> <pre><code>from genbadge import Badge\n\nb = Badge(left_txt=\"foo\", right_txt=\"bar\", color=\"green\")\nprint(b)\n</code></pre> <p>yields</p> <pre><code>[ foo | bar ]  color: green\n</code></pre> <p>By default no svg is generated: this is a purely abstract badge. You can make it a real badge with the following code:</p> <pre><code>b.write_to(\"tmp_badge.svg\", use_shields=False)\n</code></pre> <p>Note the optional <code>use_shields</code> boolean flag that is used to switch between querying <code>shields.io</code> (<code>True</code>, default) or using a local SVG file template (<code>False</code>, but maybe less bullet-proof).</p>"},{"location":"#see-also","title":"See Also","text":"<p>Other badge generation projects exist:</p> <ul> <li><code>coverage-badge</code>, see in particular this discussion</li> <li><code>flake8-svg-badge</code> that seems abandoned ?</li> </ul>"},{"location":"#others","title":"Others","text":"<p>Do you like this library ? You might also like my other python libraries </p>"},{"location":"#want-to-contribute","title":"Want to contribute ?","text":"<p>Details on the github page: https://github.com/smarie/python-genbadge</p>"},{"location":"changelog/","title":"Changelog","text":""},{"location":"changelog/#112-in-progress","title":"1.1.2 - (in progress)","text":"<ul> <li>Refactored project layout so that tests are not packaged in wheel.</li> <li><code>conda</code> is not the backend virtual environment anymore. Fixes #35.</li> </ul>"},{"location":"changelog/#111-fixed-support-for-latest-pillow-and-python","title":"1.1.1 - Fixed support for latest Pillow and Python","text":"<ul> <li>Fixed support for Python 3.12 by adding <code>setuptools</code> requirement explicitly. Fixed   #32.</li> <li>Fixed support for <code>Pillow</code> version 10 or greater. PR #33 by   famura.</li> </ul>"},{"location":"changelog/#110-option-to-change-or-remove-the-badge-name","title":"1.1.0 - Option to change or remove the badge name","text":"<ul> <li>A new <code>-n/--name</code> commandline option can be used with all badge generation commands to override the badge label (left text). A <code>--noname</code> commandline flag can alternatively be used to remove the left part completely. PR #25 by <code>nefrob</code>.</li> </ul>"},{"location":"changelog/#106-bugfix","title":"1.0.6 - Bugfix","text":"<ul> <li>Fixed the badge generator in \"local\" mode (badge created from local SVG template, not downloaded from shields.io). Fixes #19. PR #20 by <code>texnofobix</code>.</li> </ul>"},{"location":"changelog/#105-bugfix","title":"1.0.5 - Bugfix","text":"<ul> <li>Removed dependency to <code>xunitparser</code> because its packaging relies on <code>use_2to3</code> which is not supported anymore in setuptools. Fixes #18.</li> </ul>"},{"location":"changelog/#104-bugfix","title":"1.0.4 - Bugfix","text":"<ul> <li><code>genbadge coverage</code>: fixed <code>ZeroDivisionError</code> when <code>coverage.xml</code> contains 0 branches (in particular when <code>--no-branch</code> option is set). Fixes #15</li> </ul>"},{"location":"changelog/#103-technical-release","title":"1.0.3 - technical release","text":"<ul> <li><code>setup.py</code> is now using the contents of <code>setup.cfg</code> for download url and setuptools_scm. There is now a single configuration file. See setuptools_scm#582.</li> </ul>"},{"location":"changelog/#102-technical-release","title":"1.0.2 - technical release","text":"<ul> <li>Fixed the release message.</li> </ul>"},{"location":"changelog/#101-bugfix-defusedxml-import","title":"1.0.1 - bugfix - <code>defusedxml</code> import","text":"<ul> <li><code>genbadge coverage</code> command: fixed <code>ImporError</code> with <code>defusedxml</code>. Fixed #14.</li> </ul>"},{"location":"changelog/#100-security-patch-simplified-tests-badge","title":"1.0.0 - security patch + simplified tests badge","text":"<ul> <li> <p>The tests badge now simplifies when the success rate is 100%, which is the case in the vast majority of projects. Fixes #12</p> </li> <li> <p>Now using <code>defusedxml</code> to fix a known vulnerability. Fixes #11</p> </li> </ul>"},{"location":"changelog/#080-new-features","title":"0.8.0 - New features","text":"<ul> <li>Added <code>flake8</code> command. Fixes #3.</li> <li>Added a \"silent\" flag <code>-s</code>. Fixes #10</li> <li>Added a verbosity flag <code>-v</code>. Fixes #1</li> <li>Python 3.9 is now officially supported. Fixes #9</li> </ul>"},{"location":"changelog/#071-bugfix","title":"0.7.1 - Bugfix","text":"<ul> <li>Fixed bug with writing to stdout. Fixed #8.</li> </ul>"},{"location":"changelog/#070-badges-can-be-written-to-stdout","title":"0.7.0 - Badges can be written to stdout","text":"<ul> <li>Completed CLI help for subcommands. Fixes #5</li> <li>Badges can now be redirected to <code>stdout</code> using <code>genbadge &lt;cmd&gt; -o -</code>. Fixes #4</li> </ul>"},{"location":"changelog/#060-added-coverage-command","title":"0.6.0 - Added <code>coverage</code> command","text":"<ul> <li>New command <code>genbadge coverage</code> able to generate a badge from a <code>coverage.xml</code> coverage report</li> </ul>"},{"location":"changelog/#050-first-public-version","title":"0.5.0 - First public version","text":"<ul> <li>Command group <code>genbadge</code> with global help</li> <li> <p>Command <code>genbadge tests</code> able to generate a badge from a <code>junit.xml</code> tests report, with :</p> <ul> <li>color depending on success percentage (50%/75%/90%)</li> <li>customization of input <code>junit.xml</code> file and output SVG badge file,</li> <li>custom source (<code>shields.io</code> by default or local SVG file template for offline usage).</li> <li>\"fail on threshold\" option to return an error code 1 when the success percentage is strictly lower than the threshold.</li> </ul> </li> </ul>"},{"location":"long_description/","title":"python-genbadge","text":"<p>Define fields in python classes. Easily.</p> <p> </p> <p> </p> <p>The documentation for users is available here: https://smarie.github.io/python-genbadge/</p> <p>A readme for developers is available here: https://github.com/smarie/python-genbadge</p>"}]}